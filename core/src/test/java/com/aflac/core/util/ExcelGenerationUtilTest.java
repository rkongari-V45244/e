//
//package com.aflac.core.util;
//
//import static org.junit.jupiter.api.Assertions.assertEquals;
//import static org.mockito.ArgumentMatchers.anyString;
//import static org.mockito.Mockito.mock;
//import static org.mockito.Mockito.when;
//
//import java.io.IOException;
//import java.io.InputStream;
//
//import org.apache.poi.xssf.usermodel.XSSFWorkbook;
//import org.apache.sling.api.SlingHttpServletRequest;
//import org.apache.sling.api.resource.Resource;
//import org.apache.sling.api.resource.ResourceResolver;
//import org.junit.jupiter.api.BeforeAll;
//import org.junit.jupiter.api.Test;
//import org.junit.jupiter.api.extension.ExtendWith;
//
//import com.aflac.core.experience.api.model.ComplianceVerbiageDetail;
//import com.aflac.core.experience.api.model.LabelSequence;
//import com.aflac.core.osgi.service.CaseBuilderService;
//import com.aflac.core.osgi.service.ComplianceService;
//import com.day.cq.dam.api.Asset;
//import com.day.cq.dam.api.Rendition;
//
//import io.wcm.testing.mock.aem.junit5.AemContextExtension;
//
//@ExtendWith(AemContextExtension.class)
//public class ExcelGenerationUtilTest {
//	
//	private static String formData;
//	private static ExcelGenerationUtil util;
//		
//	@BeforeAll
//	public static void setup() {
//		util = new ExcelGenerationUtil();
//	}
//	
//	@Test
//	public void excelUtilTest() throws IOException {
//		formData = "<?xml version=\"1.0\" encoding=\"UTF-8\"?><afData><afUnboundData><data><CriticalIllnessCheckbox>Critical Illness-With Cancer</CriticalIllnessCheckbox><DisablityCheckbox>Disability</DisablityCheckbox><WholeLifeCheckbox>Whole Life</WholeLifeCheckbox><TermLifeCheckbox>Term Life</TermLifeCheckbox><selectedProducts>Critical Illness-With Cancer,Disability,Whole Life,Term Life,</selectedProducts><DisablityMultiPlansNumber>2</DisablityMultiPlansNumber><formCase>Add</formCase><startTime>2023-07-07 16:01:40 Asia/Calcutta</startTime><AI_EnrollmentConditionCheckbox>true</AI_EnrollmentConditionCheckbox><AI_EnrollmentCommonCheckBox>Self-Service</AI_EnrollmentCommonCheckBox><childIssueAgeUnit>Days</childIssueAgeUnit><instructionsNeededCheckbox>No</instructionsNeededCheckbox><EligibleEmployees>12</EligibleEmployees><R_groupNumber>0000001234</R_groupNumber><R_AccountName>Test1</R_AccountName><R_SitusState>AL</R_SitusState><R_PlatformSoftware>Buck Advantage</R_PlatformSoftware></data></afUnboundData><afBoundData><caseBuilderForm xmlns:xfa=\"http://www.xfa.org/schema/xfa-data/1.0/\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"><groupNo>0000001234</groupNo><coverageEffectiveDate>2023-07-25</coverageEffectiveDate><enrollmentRecord/><enrollmentPlatform>100106|Buck Advantage|Conduent</enrollmentPlatform><accountInformation><groupNumber>0000001234</groupNumber><groupType>Employer Group</groupType><accountName>Test1</accountName><situsState>AL</situsState><ssn>EEID</ssn><eligibleEmployees>12</eligibleEmployees><deductionFrequency>Annually</deductionFrequency><platformSplitValue>Buck Advantage</platformSplitValue><locations/><platform>100106|Buck Advantage|Conduent</platform><productSold>Critical Illness-With Cancer,Disability,Whole Life,Term Life</productSold><coverageBillingEffDate>2023-07-25</coverageBillingEffDate><openEnrollmentStartDate>2023-07-27</openEnrollmentStartDate><openEnrollmentEndDate>2023-07-29</openEnrollmentEndDate><siteTestInfoDueDate/><enrollmentConditionOptions>Self-Service</enrollmentConditionOptions><newHire>Self-Service</newHire><implementationManager>test</implementationManager><implementationManagerEmail>test@t</implementationManagerEmail><clientManager>test</clientManager><clientManagerEmail>test@w</clientManagerEmail><partnerPlatformManager>test</partnerPlatformManager><partnerPlatformManagerEmail>test@w</partnerPlatformManagerEmail><partnerEligible>Yes</partnerEligible></accountInformation><fileSubmission><productionFileNaming>test</productionFileNaming><testFileNaming>test</testFileNaming><productionFileDueDate>2023-7-10</productionFileDueDate><testFileDueDate>2023-8-3</testFileDueDate></fileSubmission><locations><locationSpecified>Yes</locationSpecified><location><locationName>test</locationName><locationState>test</locationState><locationCode>123</locationCode></location></locations><products><product><productName>Critical Illness-With Cancer</productName><productId>1</productId><planName>Group Critical Illness Insurance-With Cancer</planName><planLevel/><series>2100</series><applicationNumber>123</applicationNumber><taxType>Pre-Tax</taxType><hoursWorkedPerWeek>16</hoursWorkedPerWeek><eligibilityWaitingPeriod>12</eligibilityWaitingPeriod><ageCalculation>Attained Age</ageCalculation><hireDate/><productRecord/><platformDriven>Coverage Effective Date</platformDriven><ageCalculated>Employee &amp; Spouse Ages Captured Separately</ageCalculated><employeeIssueAge>18-69, Cannot enroll after age 69</employeeIssueAge><spouseIssueAge>18-69, Cannot enroll after age 69</spouseIssueAge><childIssueAge>0-26, Cannot enroll after age 26*</childIssueAge><participationRequirement>10%</participationRequirement><hundredPercentGuranteed>Yes</hundredPercentGuranteed><progressiveRider>Yes</progressiveRider><optionalRider>Yes</optionalRider><employeeAmountOffered><amountOffered><minimumAmtElect>100</minimumAmtElect><maximumAmtElect>200</maximumAmtElect><increments>100</increments><guaranteedIssueMaximum>100</guaranteedIssueMaximum></amountOffered></employeeAmountOffered><spouseAmountOffered><amountOffered><minimumAmtElect>100</minimumAmtElect><maximumAmtElect>200</maximumAmtElect><increments>100</increments><guaranteedIssueMaximum>100</guaranteedIssueMaximum></amountOffered></spouseAmountOffered><eeBenefitAmounts><benefitAmount><amount>100</amount></benefitAmount><benefitAmount><amount>200</amount></benefitAmount></eeBenefitAmounts><spBenefitAmounts><benefitAmount><amount>100</amount></benefitAmount><benefitAmount><amount>200</amount></benefitAmount></spBenefitAmounts><tdiStatesBenefitAmounts><benefitAmount><amount/></benefitAmount></tdiStatesBenefitAmounts><chIndividualPolicyBenefitAmounts><benefitAmount><amount/></benefitAmount></chIndividualPolicyBenefitAmounts><chBenefitAmounts><benefitAmount><amount/></benefitAmount></chBenefitAmounts><benefitAmountPercentage>10%</benefitAmountPercentage><tobacco><tobaccoStatus>Tobacco Distinct - Tobacco Status Required</tobaccoStatus><tobaccoStatusDetermined>Employee &amp; Spouse Tobacco Status Captured Separately</tobaccoStatusDetermined></tobacco><otherInstructions>test</otherInstructions></product><product><productName>Disability</productName><productId>2</productId><planName>Group Disability Insurance</planName><planLevel/><series>5000</series><coverageLevel>test</coverageLevel><applicationNumber>C02205AL</applicationNumber><taxType>Pre-Tax</taxType><hoursWorkedPerWeek>19</hoursWorkedPerWeek><eligibilityWaitingPeriod>12</eligibilityWaitingPeriod><ageCalculation>Attained Age</ageCalculation><hireDate/><productRecord/><platformDriven>Coverage Effective Date</platformDriven><employeeIssueAge>18-69, Cannot enroll after age 69</employeeIssueAge><spouseIssueAge/><childIssueAge/><participationRequirement>12%</participationRequirement><hundredPercentGuranteed>Yes</hundredPercentGuranteed><progressiveRider>No</progressiveRider><optionalRider>No</optionalRider><employeeAmountOffered><amountOffered><minimumAmtElect>100</minimumAmtElect><maximumAmtElect>200</maximumAmtElect><increments>100</increments><guaranteedIssueMaximum>100</guaranteedIssueMaximum></amountOffered></employeeAmountOffered><TdiStateAmountOffered><amountOffered><minimumAmtElect>100</minimumAmtElect><maximumAmtElect>200</maximumAmtElect><increments>100</increments><guaranteedIssueMaximum>100</guaranteedIssueMaximum></amountOffered></TdiStateAmountOffered><eeBenefitAmounts><benefitAmount><amount/></benefitAmount></eeBenefitAmounts><spBenefitAmounts><benefitAmount><amount/></benefitAmount></spBenefitAmounts><tdiStatesBenefitAmounts><benefitAmount><amount/></benefitAmount></tdiStatesBenefitAmounts><chIndividualPolicyBenefitAmounts><benefitAmount><amount/></benefitAmount></chIndividualPolicyBenefitAmounts><chBenefitAmounts><benefitAmount><amount/></benefitAmount></chBenefitAmounts><isUniqueIncrementsUtilized>Y</isUniqueIncrementsUtilized><benefitAmountDescription>test</benefitAmountDescription><benefitType>Non-Occupational</benefitType><benefitPeriod>12-months</benefitPeriod><eliminationPeriod>0/7</eliminationPeriod><otherInstructions>test</otherInstructions></product><product><productName>Whole Life</productName><productId>3</productId><planName>Group Whole Life Insurance</planName><planLevel/><series>9800</series><applicationNumber>C02205AL</applicationNumber><taxType>Pre-Tax</taxType><hoursWorkedPerWeek>16</hoursWorkedPerWeek><eligibilityWaitingPeriod>12</eligibilityWaitingPeriod><hireDate/><productRecord/><platformDriven>Coverage Effective Date</platformDriven><ageCalculated>Employee &amp; Spouse Ages Captured Separately</ageCalculated><employeeIssueAge>18-70, Cannot enroll after age 70</employeeIssueAge><spouseIssueAge>18-70, Cannot enroll after age 70</spouseIssueAge><childIssueAge>15 days â€“ 24 years, Cannot enroll before 15 Days and after age 24*</childIssueAge><participationRequirement>12%</participationRequirement><hundredPercentGuranteed>Yes</hundredPercentGuranteed><progressiveRider>No</progressiveRider><optionalRider>No</optionalRider><acceleratedDeathBenefitOffered>Yes</acceleratedDeathBenefitOffered><employeeAmountOffered><amountOffered><minimumAmtElect>100</minimumAmtElect><maximumAmtElect>200</maximumAmtElect><increments>100</increments><guaranteedIssueMaximum>100</guaranteedIssueMaximum></amountOffered></employeeAmountOffered><spouseAmountOffered><amountOffered><minimumAmtElect>100</minimumAmtElect><maximumAmtElect>100</maximumAmtElect><increments>100</increments><guaranteedIssueMaximum>100</guaranteedIssueMaximum></amountOffered></spouseAmountOffered><eeBenefitAmounts><benefitAmount><amount/></benefitAmount></eeBenefitAmounts><spBenefitAmounts><benefitAmount><amount/></benefitAmount></spBenefitAmounts><tdiStatesBenefitAmounts><benefitAmount><amount/></benefitAmount></tdiStatesBenefitAmounts><chIndividualPolicyBenefitAmounts><benefitAmount><amount/></benefitAmount></chIndividualPolicyBenefitAmounts><chBenefitAmounts><benefitAmount><amount/></benefitAmount></chBenefitAmounts><isChildCoverageOffered>Y</isChildCoverageOffered><childCoverageOffered>10000,25000</childCoverageOffered><isChildTermlifeRiderOffered>Y</isChildTermlifeRiderOffered><isUniqueIncrementsUtilized>Y</isUniqueIncrementsUtilized><benefitAmountDescription>test</benefitAmountDescription><tobacco><tobaccoStatus>Tobacco Distinct - Tobacco Status Required</tobaccoStatus><tobaccoStatusDetermined>Employee &amp; Spouse Tobacco Status Captured Separately</tobaccoStatusDetermined></tobacco></product><product><productName>Term Life</productName><productId>4</productId><planName>Group Term Life Insurance</planName><planLevel/><series>9100</series><applicationNumber>C02205AL</applicationNumber><taxType>Pre-Tax</taxType><hoursWorkedPerWeek>16</hoursWorkedPerWeek><eligibilityWaitingPeriod>21</eligibilityWaitingPeriod><term>5</term><hireDate/><productRecord/><platformDriven>Coverage Effective Date</platformDriven><ageCalculated>Employee &amp; Spouse Ages Captured Separately</ageCalculated><employeeIssueAge>18-70, Cannot enroll after age 70</employeeIssueAge><spouseIssueAge>18-70, Cannot enroll after age 70</spouseIssueAge><childIssueAge>0-25, Cannot enroll after age 25*</childIssueAge><participationRequirement>12%</participationRequirement><hundredPercentGuranteed>Yes</hundredPercentGuranteed><progressiveRider>No</progressiveRider><optionalRider>No</optionalRider><employeeAmountOffered><amountOffered><minimumAmtElect>100</minimumAmtElect><maximumAmtElect>200</maximumAmtElect><increments>100</increments><guaranteedIssueMaximum>100</guaranteedIssueMaximum></amountOffered></employeeAmountOffered><spouseAmountOffered><amountOffered><minimumAmtElect>100</minimumAmtElect><maximumAmtElect>200</maximumAmtElect><increments>100</increments><guaranteedIssueMaximum>100</guaranteedIssueMaximum></amountOffered></spouseAmountOffered><childAmountOffered><amountOffered><minimumAmtElect>100</minimumAmtElect><maximumAmtElect>200</maximumAmtElect><increments>100</increments><guaranteedIssueMaximum>100</guaranteedIssueMaximum></amountOffered></childAmountOffered><eeBenefitAmounts><benefitAmount><amount/></benefitAmount></eeBenefitAmounts><spBenefitAmounts><benefitAmount><amount/></benefitAmount></spBenefitAmounts><tdiStatesBenefitAmounts><benefitAmount><amount/></benefitAmount></tdiStatesBenefitAmounts><chIndividualPolicyBenefitAmounts><benefitAmount><amount/></benefitAmount></chIndividualPolicyBenefitAmounts><chBenefitAmounts><benefitAmount><amount/></benefitAmount></chBenefitAmounts><tobacco><tobaccoStatus>Tobacco Distinct - Tobacco Status Required</tobaccoStatus><tobaccoStatusDetermined>Employee &amp; Spouse Tobacco Status Captured Separately</tobaccoStatusDetermined></tobacco></product></products></caseBuilderForm></afBoundData><afSubmissionInfo><lastFocusItem>guide[0].guide1[0].guideRootPanel[0].OuterPanel[0].HealthForm[0].Review[0]</lastFocusItem><stateOverrides><element><somExpr>guideRootPanel[0].OuterPanel[0].HealthForm[0].Products[0].Product[0].PlanDetails[0].Series[0]</somExpr><options><option><saveValue>7700</saveValue><displayValue>7700</displayValue></option><option><saveValue>7800</saveValue><displayValue>7800</displayValue></option><option><saveValue>70000</saveValue><displayValue>70000</displayValue></option></options></element><element><somExpr>guideRootPanel[0].OuterPanel[0].HealthForm[0].Products[0].Product[0].PlanDetails[0].PlanName[0]</somExpr><options><option><saveValue>Group Accident Insurance-High</saveValue><displayValue>Group Accident Insurance-High</displayValue></option><option><saveValue>Group Accident Insurance-Mid</saveValue><displayValue>Group Accident Insurance-Mid</displayValue></option><option><saveValue>Group Accident Insurance-Low</saveValue><displayValue>Group Accident Insurance-Low</displayValue></option><option><saveValue>Group Accident Insurance-High-LT</saveValue><displayValue>Group Accident Insurance-High-LT</displayValue></option><option><saveValue>Group Accident Insurance-Mid-LT</saveValue><displayValue>Group Accident Insurance-Mid-LT</displayValue></option><option><saveValue>Group Accident Insurance-Low-LT</saveValue><displayValue>Group Accident Insurance-Low-LT</displayValue></option></options></element><element><somExpr>guideRootPanel[0].OuterPanel[0].HealthForm[0].Products[0].Product[0].PlanDetails[0].Series[0]</somExpr><options><option><saveValue>20000</saveValue><displayValue>20000</displayValue></option><option><saveValue>2100</saveValue><displayValue>2100</displayValue></option><option><saveValue>2800</saveValue><displayValue>2800</displayValue></option><option><saveValue>21000</saveValue><displayValue>21000</displayValue></option><option><saveValue>22000</saveValue><displayValue>22000</displayValue></option></options></element><element><somExpr>guideRootPanel[0].OuterPanel[0].HealthForm[0].Products[0].Product[0].PlanDetails[0].PlanName[0]</somExpr><options><option><saveValue>Group Critical Illness Insurance-With Cancer</saveValue><displayValue>Group Critical Illness Insurance-With Cancer</displayValue></option><option><saveValue>Group Critical Illness Insurance-Without Cancer</saveValue><displayValue>Group Critical Illness Insurance-Without Cancer</displayValue></option><option><saveValue>Group Critical Illness Insurance-With Health Screening Benefit</saveValue><displayValue>Group Critical Illness Insurance-With Health Screening Benefit</displayValue></option><option><saveValue>Group Critical Illness Insurance-Without Health Screening Benefit</saveValue><displayValue>Group Critical Illness Insurance-Without Health Screening Benefit</displayValue></option></options></element><element><somExpr>guideRootPanel[0].OuterPanel[0].HealthForm[0].Products[0].Product[1].PlanDetails[0].Series[0]</somExpr><options><option><saveValue>5000</saveValue><displayValue>5000</displayValue></option><option><saveValue>50000</saveValue><displayValue>50000</displayValue></option></options></element><element><somExpr>guideRootPanel[0].OuterPanel[0].HealthForm[0].Products[0].Product[2].PlanDetails[0].Series[0]</somExpr><options><option><saveValue>9800</saveValue><displayValue>9800</displayValue></option><option><saveValue>60000</saveValue><displayValue>60000</displayValue></option></options></element><element><somExpr>guideRootPanel[0].OuterPanel[0].HealthForm[0].Products[0].Product[2].PlanDetails[0].PlanName[0]</somExpr><options><option><saveValue>Group Whole Life Insurance</saveValue><displayValue>Group Whole Life Insurance</displayValue></option></options></element><element><somExpr>guideRootPanel[0].OuterPanel[0].HealthForm[0].Products[0].Product[3].PlanDetails[0].Series[0]</somExpr><options><option><saveValue>9100</saveValue><displayValue>9100</displayValue></option><option><saveValue>91000</saveValue><displayValue>91000</displayValue></option></options></element><element><somExpr>guideRootPanel[0].OuterPanel[0].HealthForm[0].Products[0].Product[3].PlanDetails[0].PlanName[0]</somExpr><options><option><saveValue>Group Term Life Insurance</saveValue><displayValue>Group Term Life Insurance</displayValue></option></options></element><element><somExpr>guideRootPanel[0].OuterPanel[0].HealthForm[0].Products[0].Product[1].PlanDetails[0].PlanName[0]</somExpr><options><option><saveValue>Group Disability Insurance</saveValue><displayValue>Group Disability Insurance</displayValue></option></options></element></stateOverrides><signers/></afSubmissionInfo></afData>";
//		ComplianceVerbiageDetail cd = new ComplianceVerbiageDetail();
//		LabelSequence ls = new LabelSequence();
//		SlingHttpServletRequest request = mock(SlingHttpServletRequest.class);
//		CaseBuilderService casebuilService = mock(CaseBuilderService.class);
//		ComplianceService complianceService = mock(ComplianceService.class);
//		ResourceResolver resolver = mock(ResourceResolver.class);
//		Resource resource = mock(Resource.class);
//		Asset asset = mock(Asset.class);
//		Rendition res = mock(Rendition.class);
//		when(request.getResourceResolver()).thenReturn(resolver);
//		when(resolver.getResource(anyString())).thenReturn(resource);
//		when(resource.adaptTo(Asset.class)).thenReturn(asset);
//		when(asset.getOriginal()).thenReturn(res);
//		when(res.adaptTo(InputStream.class)).thenReturn(null);
//		when(casebuilService.getComplianceVerbiage(anyString(), anyString(), anyString())).thenReturn(cd);
//		when(complianceService.getLabelSequence()).thenReturn(ls);
//		
//		XSSFWorkbook workBook = util.generateExcel(formData, request, casebuilService, complianceService);
//		
//		String name = workBook.getSheetName(1);
//		
//		assertEquals("File Submission", name);
//		
//	}
//}
